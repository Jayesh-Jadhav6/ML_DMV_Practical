import numpy as np
import pandas as pd 
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression ,Ridge , Lasso
from sklearn.metrics import mean_squared_error , r2_score

df = pd.read_csv('uber.csv')
df.info()
df.isnull().sum()

df.head()

df.drop_duplicates(inplace = True)
df.dropna(inplace = True)

sns.boxplot(x=df['fare_amount'])
plt.title('fare amount outliers ')
plt.show()

sns.heatmap(df.select_dtypes(np.number).corr() , annot = True , cmap = 'coolwarm')
plt.title('correlation matrix')
plt.show()

x = df.select_dtypes(np.number).drop('fare_amount',axis=1, errors='ignore')
y = df['fare_amount']

x_train ,x_test, y_train ,y_test = train_test_split(x,y , test_size = 0.2 ,random_state = 42)

for name, model in [
    ('Linear', LinearRegression()),
    ('Ridge', Ridge(1.0)),
    ('Lasso', Lasso(0.1))
]:
    model.fit(x_train, y_train)
    y_pred = model.predict(x_test)
    
    rmse = np.sqrt(mean_squared_error(y_test, y_pred))
    r2 = r2_score(y_test, y_pred)
    
    print (name , "RMSE" , rmse , "R2" , r2)



